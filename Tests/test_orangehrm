import pytest
from selenium import webdriver
from PageObjects.LoginPage import LoginPage
from PageObjects.DashboardPage import DashboardPage
from PageObjects.LeavePage import LeavePage
import time

class Test_OrangeHRM:
    base_url = "https://opensource-demo.orangehrmlive.com/web/index.php/auth/login"
    username = "Admin"
    password = "admin123"

    @pytest.fixture(scope="class")
    def setup(self):
        driver = webdriver.Chrome()
        driver.get(self.base_url)
        driver.maximize_window()
        yield driver
        driver.quit()

    def test_login_page_title(self, setup):
        assert "OrangeHRM" in setup.title

    def test_login(self, setup):
        lp = LoginPage(setup)
        lp.setUsername(self.username)
        lp.setPassword(self.password)
        lp.clickLogin()
        time.sleep(3)
        assert "dashboard" in setup.current_url.lower()

    def test_my_leave_navigation(self, setup):
        dp = DashboardPage(setup)
        dp.clickMyLeave()
        time.sleep(2)
        lv = LeavePage(setup)
        assert lv.verifyLeavePage()

    def test_logout(self, setup):
        dp = DashboardPage(setup)
        dp.clickProfileDropdown()
        time.sleep(1)
        dp.clickLogout()
        time.sleep(2)
        assert "login" in setup.current_url.lower()
